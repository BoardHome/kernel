/dts-v1/;

#include "rk3399-firefly-port.dtsi"
#include <dt-bindings/sensor-dev.h>
#include <dt-bindings/display/media-bus-format.h>

/ {
	test-power {
		status = "okay";
	};

	rt5640-sound {
		simple-audio-card,cpu {
		        sound-dai = <&i2s1>;
		};
		simple-audio-card,codec {
		        sound-dai = <&rt5640>;
		};
	};

	fan_ctl: fan-ctl-regulator {
		compatible = "regulator-fixed";
		enable-active-high;
		regulator-always-on;
		regulator-boot-on;
		gpio = <&gpio3 10 GPIO_ACTIVE_HIGH>;
		pinctrl-names = "default";
		regulator-name = "fan_ctl";
		pinctrl-0 = <&fan_drv>;
	};

	NPU5801_PWR_EN: HUB20-PWR-EN {
		compatible = "regulator-fixed";
		enable-active-high;
		regulator-always-on;
		regulator-boot-on;
		gpio = <&gpio0 2 GPIO_ACTIVE_HIGH>;
		pinctrl-names = "default";
		pinctrl-0 = <&npu5801_pwr_en>;
		regulator-name = "vcc5v0_5801_en";
		status = "okay";
	};

	// vcc5v0_typec0_en: vcc5v0-typec0-en-regulator {
	// 	compatible = "regulator-fixed";
	// 	enable-active-high;
	// 	gpio = <&gpio1 3 GPIO_ACTIVE_HIGH>;
	// 	pinctrl-names = "default";
	// 	pinctrl-0 = <&vcc5v0_typec0_en_drv>;
	// 	regulator-name = "vcc5v0_typec0_en";
	// 	regulator-always-on;
	// };

	dc_12v: dc-12v {
        compatible = "regulator-fixed";
        regulator-name = "dc_12v";
        regulator-always-on;
        regulator-boot-on;
        regulator-min-microvolt = <12000000>;
        regulator-max-microvolt = <12000000>;
    };

	vcc5v0_usb: vcc5v0-usb {
        compatible = "regulator-fixed";
        regulator-name = "vcc5v0_usb";
        regulator-always-on;
        regulator-boot-on;
        regulator-min-microvolt = <5000000>;
        regulator-max-microvolt = <5000000>;
        vin-supply = <&dc_12v>;
    };

	vcc5v0_otg: vcc5v0-otg-regulator {
        compatible = "regulator-fixed";
        regulator-name = "vcc5v0_otg";
        regulator-min-microvolt = <5000000>;
        regulator-max-microvolt = <5000000>;
        enable-active-high;
        gpio = <&gpio1 RK_PA3 GPIO_ACTIVE_HIGH>;
        vin-supply = <&vcc5v0_usb>;
        pinctrl-names = "default";
        pinctrl-0 = <&vcc5v0_otg_en>;
    };
};

&gmac {
	tx_delay = <0x2F>;
	rx_delay = <0x1E>;
};


&vcc_sd_h {
	rockchip,pins = <1 22 RK_FUNC_GPIO &pcfg_pull_up>;
};

&vcc_sd {
	gpio = <&gpio1 22 GPIO_ACTIVE_HIGH>;
};

&hdmi_dp_sound {
	status = "okay";
};

&i2c2 {
	status = "disabled";
	i2c-scl-rising-time-ns = <300>;
	i2c-scl-falling-time-ns = <15>;

	sensor@4c {
		status = "disabled";
		compatible = "gs_mc3230";
		reg = <0x4c>;
		type = <SENSOR_TYPE_ACCEL>;
		irq_enable = <0>;
		poll_delay_ms = <30>;
		layout = <1>;
	};
};

&rt5640 {
    hp-det-adc-value = <900>;
    aux-det-adc-value = <900>;
    hp-con-gpio = <&gpio3 16 GPIO_ACTIVE_HIGH>;
    io-channels = <&saradc 3>,<&saradc 2>;
    io-channel-names = "hp-det","aux-det";
};

&rt5640_hpcon{
    rockchip,pins = <3 16 RK_FUNC_GPIO &pcfg_pull_none>;
};

&vcca1v8_codec {
	regulator-min-microvolt = <900000>;
	regulator-max-microvolt = <900000>;
};

&spi1 {
	dev-port = <0>;
	status = "okay";
};

&spi_wk2xxx {
    status = "okay";
	reset-gpio = <&gpio1 2 GPIO_ACTIVE_HIGH>;
	irq-gpio = <&gpio2 8 IRQ_TYPE_EDGE_FALLING>;
	cs-gpio = <&gpio1 10 GPIO_ACTIVE_HIGH>;
};

&vcc3v3_3g {
	gpio = <&gpio2 28 GPIO_ACTIVE_HIGH>;
};

&vcc3v3_pcie {
	/delete-property/ gpio;
};

&pcie0 {
	ep-gpios = <&gpio4 30 GPIO_ACTIVE_HIGH>;
};

&uart4 {
    status = "disabled";
};

&dp_in_vopb {
	status = "disabled";
};

&hdmi_in_vopl {
	status = "disabled";
};

&io_domains {
	bt656-supply = <&vcc_3v0>;
};

&vcc2v8_dvp {
	regulator-min-microvolt = <1800000>;
	regulator-max-microvolt = <1800000>;
};

&vcca1v8_codec {
	regulator-min-microvolt = <900000>;
	regulator-max-microvolt = <900000>;
};

&fusb0 {
    status = "disabled";
};

&cdn_dp {
    status = "disabled";
};

&tcphy0 {
    /delete-property/ extcon;
    status = "okay";
};

&u2phy0 {
    status = "okay";
    /delete-property/ extcon;
};

&u2phy0_otg {
    vbus-supply = <&vcc5v0_otg>;
    status = "okay";
};

&usbdrd3_0 {
    status = "okay";
    /delete-property/ extcon;
};

&usbdrd_dwc3_0 {
    dr_mode = "host";
};

&route_hdmi {
	status = "okay";
};

&rk808 {
     /delete-property/ pmic,stby-gpio;
     /delete-property/ pmic,hold-gpio;
};

&vcc_mipi {
	status = "okay";
};

&dvdd_1v2 {
	status = "okay";
};

&ov13850 {
	pwdn-gpios = <&gpio2 1 GPIO_ACTIVE_HIGH>;
	status = "okay";
};

&ov13850_1 {
	pwdn-gpios = <&gpio2 0 GPIO_ACTIVE_HIGH>;
	status = "okay";
};

&rkisp1_0 {
	status = "okay";
};

&mipi_dphy_rx0 {
	status = "okay";
};

&isp0_mmu {
	status = "okay";
};

&rkisp1_1 {
	status = "okay";
};

&mipi_dphy_tx1rx1 {
	status = "okay";
};

&isp1_mmu {
	status = "okay";
};


&pinctrl {

	// usb2_en {
	// 	vcc5v0_typec0_en_drv: vcc5v0-typec0-en {
	// 		rockchip,pins =
	// 			<1 3 RK_FUNC_GPIO &pcfg_pull_up>;
	// 	};
	// };

	npu_pwr_en {
		// control VCC5V0_HOST3
		npu5801_pwr_en: npu5801-pwr-en {
			rockchip,pins =
				<0 2 RK_FUNC_GPIO &pcfg_pull_up>;
		};
	};

	host-hub-vcc {
		host_hub_vcc: host-hub-vcc {
			rockchip,pins =
				<2 4 RK_FUNC_GPIO &pcfg_output_high>,
				<4 29 RK_FUNC_GPIO &pcfg_output_high>;
		};
	};

	pcie {
		pcie_3g_drv: pcie-3g-drv {
			rockchip,pins =
				<2 6 RK_FUNC_GPIO &pcfg_pull_up>;
		};
	};

	vcc_sd {
		vcc_sd_h: vcc-sd-h {
			rockchip,pins =
				<1 22 RK_FUNC_GPIO &pcfg_pull_up>;
		};
	};

	fan-ctl {
		fan_drv: fan-drv {
			rockchip,pins = <3 10 RK_FUNC_GPIO &pcfg_pull_none>;
		};
	};
};